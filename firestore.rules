rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    
    // Default deny
    match /{document=**} {
      allow read, write: if false;
    }

    // Conventions:
    // - Public READ (get) allowed for verification page (by ID only)
    // - Collection LIST denied (to prevent scraping)
    // - Write/Delete restricted to authenticated users (existing logic assumed)
    match /conventions/{conventionId} {
      allow get: if true; // PUBLIC ACCESS by ID for ./verify/conventions/[id]
      allow list: if request.auth != null; // Only authenticated users can list
      
      // Keep existing write logic (assumed)
      allow write: if request.auth != null; 
    }

    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
  }
}
